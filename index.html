<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Catan Database</title>
    <link rel="icon" type="image/x-icon" href="media/catan-favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Lexend:wght@100..900&family=Stack+Sans+Headline:wght@200..700&display=swap"
    rel="stylesheet">

    <link href="/style.css" rel="stylesheet" type="text/css" media="all">
    <script src="code.js"></script>
</head>

<body class="background">
    <section class="catan-background-color">
        <div class="center center-text">
            <p class="catan-font catan-font-color" style="font-size: 150px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">CATAN</p>
            <p class="catan-font catan-font-color" style="font-size: 50px;">DATABASE</p>
        </div>
    </section>

    <div class="card-style" style="padding-bottom: 0px;">
        <div class="center center-text horizontal-text header-text">
            <p id="large-padding"><a href="search.html">Search Database</a></p>
            <p id="large-padding"><a href="add.html">Add</a></p>
            <p id="large-padding"><a href="alter.html">Alter</a></p>
        </div>
    </div>

    <section class="card-style">
        <h2 class="catan-font catan-font-color" style="padding-left: 10px;">PLAYERS</h2>
        <div class="grid-container">
            <ul class="card-list" id="dynamic-player-list">
                <!--
                <li>
                    <div class="person-card">
                        <img src="media/isaac.png" alt="isaac">
            
                        <div class="list">
                            <h3>STATS</h3>
                            <ul>
                                <li>TOTAL WINS:</li>
                                <li>GAMES PLAYED:</li>
                                <li>WIN PERCENTAGE:</li>
                            </ul>
                        </div>
                    </div>
                </li>
                -->
            </ul>
        </div>
    </section>

    <script>createPlayerCards()</script>
</body>

</html>

<!--
Queries to add

- search for given game with id
    - see each player in that game
    - stats about game (time taken, total trades made)
    - what did the board look like?
- search for player by name
    - total trades
    - total buildings built
    - total wins
- search trades across all games (just a single page no input required)
    - all trades made
    - trades by player
    - trades by game

-- SQL pseudocode --

* game search (given a gameID)
SELECT playerID, time_taken, total_trades, board_state (tiles only) FROM __ WHERE gameID = <given_game>

for the given game we also need facts about how each player performed in the game
SELECT victoryPoints, num_trades, buildings_built FROM __ WHERE gameID = <given_game> AND playerID = <for_each_player>

* player search (given a playerID)
these stats will be across all games
SELECT total_trades, total_buildings_built (of each type), (other simple stats) FROM player WHERE playerID = <given_player>

* trade search (no input, just all trades made)
there will be several variations of this query
SELECT * FROM trades (GROUP BY playerID)
SELECT * FROM trades WHERE playerID = <given_player_id>
SELECT * FROM trades WHERE gameID = <given_game_id>
-->

<!-- SELECT
gameID,
playerID,
playerName,
buildingType,
vertex_id

FROM (
SELECT
bt.gameID,
bt.playerID,
p.name AS playerName,
b.type AS buildingType,

# Make a vertex id ("location:build index") and then pick the smallest and the equivalent one from
# equivalence table
# ChatGPT helped me figure out how to use padding and coalesce, but I wrote the query myself
# The padding is used so that the numbers can be compared as strings
# Coalesce is used for the case that there isn't any equivalent value in the equiv table
MIN(
LEAST(
CONCAT(LPAD(gt.location,2,'0'), ':', LPAD(bt.buildIndex,2,'0')),
CONCAT(
LPAD(COALESCE(e.loc2, gt.location),2,'0'), ':', LPAD(COALESCE(e.bi2, bt.buildIndex),2,'0')
)
)
) AS vertex_id,

gt.location
FROM buildingtile bt
JOIN gametile gt
ON bt.tileID = gt.tileID AND bt.gameID = gt.gameID
LEFT JOIN equiv e
ON gt.location = e.loc1 AND bt.buildIndex = e.bi1


JOIN player p ON bt.playerID = p.playerID
JOIN building b ON bt.buildingID = b.buildingID


#edit here for different games and players
WHERE bt.gameID = <given_game>
    AND bt.playerID = <given_player_id>

        GROUP BY
        bt.gameID,
        bt.playerID,
        bt.buildingID,
        bt.buildIndex,
        gt.location,
        p.name,
        b.type
        ) AS innerq

        GROUP BY
        gameID,
        playerID,
        playerName,
        buildingType,
        vertex_id

        ORDER BY vertex_id; -->

        <!-- # - trades by game
        # SELECT p_from.name AS Player1, playertrade.fromPlayerGave AS Gave, p_to.name AS Player2, playertrade.toPlayerGave AS
        Gave
        # FROM playertrade
        # INNER JOIN player p_from ON p_from.playerID = playertrade.fromPlayerID
        # INNER JOIN player p_to ON p_to.playerID = playertrade.toPlayerID
        # INNER JOIN trade ON trade.tradeID = playertrade.tradeID
        # WHERE gameID = <given_game>
            # ORDER BY playertrade.tradeID -->